# üå§Ô∏è Weather Forecast App

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ FastAPI –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ–≥–æ–¥—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º —Å HTML-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º —Ç–æ–ø–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤.

---

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç –ü–æ–∏—Å–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ –≥–æ—Ä–æ–¥—É –Ω–∞ **—Å–µ–≥–æ–¥–Ω—è –∏–ª–∏ –∑–∞–≤—Ç—Ä–∞**
- ‚å®Ô∏è **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ** –ø—Ä–∏ –≤–≤–æ–¥–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- üç™ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –≤ Cookie
- üåê HTML-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å Bootstrap, HTMX –∏ Chart.js
- üìÅ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –≤ JSON
- üê≥ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker + –æ–±–ª–∞—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä Selectel 
- üß™ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ —á–µ—Ä–µ–∑ `pytest`


Update: –¢–∞–∫–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –≤ [–∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ](http://87.228.96.69/)
---

## üöÄ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/Dxndigiden/weather_test_api.git
cd weather_test_api
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
python -m venv venv
source venv\Scripts\activate
pip install -r requirements.txt
```

### 3. –ü—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
alembic upgrade head
```

### 4. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
uvicorn app.main:app --reload
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: [http://127.0.0.1:8000](http://127.0.0.1:8000)  
Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [http://127.0.0.1:8000/swagger](http://127.0.0.1:8000/swagger)

---

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### 1. –°–æ–±–µ—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker compose build
```

### 2. –ó–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker compose up
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: [http://127.0.0.1:8000](http://127.0.0.1:8000)

---

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
pytest
```

–õ–∏–±–æ –≤ Docker:

```bash
docker compose run web pytest
```

---

## üìÇ API –∏ –º–∞—Ä—à—Ä—É—Ç—ã

### üî∏ `GET /`

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç HTML-—Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –≥–æ—Ä–æ–¥–∞ –∏ –≤—ã–±–æ—Ä–∞ –¥–Ω—è.

---

### üî∏ `POST /`

–ü–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≥–æ—Ä–æ–¥—É –∏ –¥–Ω—é (—Å–µ–≥–æ–¥–Ω—è/–∑–∞–≤—Ç—Ä–∞), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ë–î, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–æ—Ä–º—ã:**

- `city`: –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `day`: `today` –∏–ª–∏ `tomorrow`

---

### üî∏ `GET /autocomplete?q=...`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –ø–æ –≤–≤–µ–¥—ë–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ (–º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞).

**–ü—Ä–∏–º–µ—Ä:** `/autocomplete?q=mos`

```json
["Moscow", "Mostar", "Mosul"]
```

---

### üî∏ `GET /top`

HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–∞–±–ª–∏—Ü–µ–π —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º.

---

### üî∏ `GET /api/v1/top`

JSON API —Å —Ç–æ–ø–æ–º —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤.

**–û—Ç–≤–µ—Ç:**

```json
[
  { "city": "Moscow", "count": 15 },
  { "city": "Berlin", "count": 9 }
]
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ main.py              # –ú–µ–π–Ω —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ api/                 # –†–æ—É—Ç–µ—Ä—ã
‚îú‚îÄ‚îÄ crud/                # CRUD-—Ñ—É–Ω–∫—Ü–∏–∏ (SQLAlchemy 2.0)
‚îú‚îÄ‚îÄ db/                  # –î–ë
‚îú‚îÄ‚îÄ models/              # SQLAlchemy-–º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/             # Pydantic-—Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/            # –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø–æ–≥–æ–¥—ã
‚îú‚îÄ‚îÄ templates/           # Html —à–∞–±–ª–æ–Ω—ã
‚îú‚îÄ‚îÄ static/              # –ö—Ä–∞—Å–æ—Ç–∞ (–í –¥–∞–ª—å–Ω–µ–π—à–µ–º)
tests/                   # Pytest-—Ç–µ—Å—Ç—ã (–ü–æ–∫–∞ –º–∞–ª–æ –ø–æ–∫—Ä—ã—Ç–∏—è)
alembic/                 # –ú–∏–≥—Ä–∞—Ü–∏–∏
```

---

## üßæ –ê–≤—Ç–æ—Ä

–ê–≤—Ç–æ—Ä: [Dxndigiden](https://github.com/Dxndigiden)